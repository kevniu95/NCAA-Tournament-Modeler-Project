<!DOCTYPE html>
<html>
	<head>	
		<title>Simulation</title>
		<link rel="stylesheet" href="../static/css/style.css?ac">
	</head>
  	<body>
		<!-- Headings -->
		<div style="box-shadow: 0 4px 8px 0 rgba(0,0,0,0.1); transition: 0.3s; width:80%;";>
			<div style = "float:right">
				<h1 style="margin:35px"> </h3>
				<h2 style="margin:0; text-align:right">Score: {{ results['score'] }} pts</h2>
			</div>	
			<div>
				<h1 style="margin:0">
					<a style="text-decoration: none; color:black" href = "{{ url_for('entrySummary', entryId = results['entry_id']) }}">ESPN Bracket Entry {{ espnId }}</a>
				</h1>
				<h2 style="margin:0">Simulation #{{ results['simulation_id'] }}</h2>
			</div>
		</div>
	<div>
		<a style="font-size:24px" href = "{{ url_for('entrySummary', entryId = results['entry_id']) }}">View entry summary</a>
	</div>
	
	<br>
	
	<!-- <section class = "faq-container">
		<div class = "faq-one"> -->
			<!-- faq question -->
			<!-- <h1 class="faq-page">What is an FAQ Page?</h1> -->
			<!-- faq answer -->
			<!-- <div class="faq-body">
				<p>Lorem ipsum dolor, sit amet consectetur adipisicing elit. Velit saepe sequi, illum facere
					necessitatibus cum aliquam id illo omnis maxime, totam soluta voluptate amet ut sit ipsum
					aperiam.
					Perspiciatis, porro!</p>
			</div>
		</div>
	</section>
 	
	<hr class="hr-line"> -->
	
	<div style="box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2); transition: 0.3s;">
		<h2 style="margin:0">A. Performance against competitors</h2>
		<h3 style="margin:0">-Here's how the entry fared against its competitors in this simulation...</h3>
		<br>
		<table id="vsPool" class="table table-striped">
			<thead>
			  <tr>
				<th># of competitors</th>
				<th>Histogram</th>
				<th>Percentile</th>
				</tr>
			</thead>
			<tbody>
			  {% for k, v in results['entryAtSize'].items() %}
				<tr>
				  <td align='right'>{{ k }}</td>
				  <td> <img src = "data:image/png;base64, {{ v['histPlot'].decode('utf-8') }}" height = 250 width = 350> </td> 
				  <td align='right'> {{ v['percentile']}}%</td>
				  </tr>
			  {% endfor %}
			</tbody>
		  </table>
	</div>	
	
	<br>
	
	<!-- Headings -->
	<div style="box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2); transition: 0.3s;">
		<h2 style="margin:0">B. Correct picks</h2>
		<h3 style="margin:0">-Here's what the entry got right and wrong in this simulation...</h3>
		<br>
		<table id="vsSim" class="table table-striped">
			<thead>
			<tr>
				<th style="outline: thin solid">Round</th>
				<th style="outline: thin solid">Game #</th>
				<th style="outline: thin solid">Simulated Winner</th>
				<th style="outline: thin solid">Your Selected Winner</th>
				<th style="outline: thin solid">Your Score</th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td align='center' style="font-size:24px"><strong>Total</strong></td>
					<td align='center'></td>
					<td align='center'></td>
					<td align='center'></td>
					<td align='center' style="font-size:24px"><strong>{{ results['score']}} / 1920</strong></td>
				</tr>
			{% for i in results['visualization'] %}
				<tr>
				<td align='center'>{{ i['label'] }}</td>
				<td align='center'>{{ i['gameNum'] }}</td>
				<td align='left'><img src = "{{ i['c_team']['img'] }}" height = 30 width = 30> {{ i['c_team']['name'] }} ({{i['c_team']['seed']}})</td>
				<td align='left'><img src = "{{ i['u_team']['img'] }}" height = 30 width = 30> {{ i['u_team']['name'] }} ({{i['u_team']['seed']}})</td>
				<td align='center'>{{ i['score'] }}</td>
				</tr>
			{% endfor %}
			</tbody>
		</table>
	</div>

	<br>
	
	<div class = "url-form">
		<form action="{{ url_for('results')}}" method="POST">
			<div>
				<label>Submit to simulate again! Or return <a href = "{{ url_for('simulate') }}">home</a> to simulate another entry</label>
			</div>
			<input type="hidden" name ="espnLink" value = "{{ espnLink }}">
			<input type="submit" name="submit" value="Submit">
		</form>
	</div>
	</body>
	
	<script>
	var t = document.getElementById('vsSim');
	if(t) {
		Array.from(t.rows).forEach((tr, rowIdx) => {
			Array.from(tr.cells).forEach((cell, cellIdx) => {
				if (rowIdx == 1){
					tr.style.backgroundColor = 'RGBA(0, 0, 0, 0.05)'
				}
				else if (cellIdx == 4 && rowIdx > 1){
					if (cell.innerText.charAt(0) != '0'){
						tr.style.backgroundColor = 'RGBA(111, 245, 111, 0.5)'
					}
					else{
						tr.style.backgroundColor = 'RGBA(241, 157, 157, 0.5)'

					}
				}
			});
		});
	}
	var faq = document.getElementsByClassName("faq-page");
	var i;
	for (i = 0; i < faq.length; i++) {
		faq[i].addEventListener("click", function () {
			/* Toggle between adding and removing the "active" class,
			to highlight the button that controls the panel */
			this.classList.toggle("active");
			/* Toggle between hiding and showing the active panel */
			var body = this.nextElementSibling;
			if (body.style.display === "block") {
				body.style.display = "none";
			} else {
				body.style.display = "block";
			}
		});
	}
	
	</script>
</html> 